## Panchan detection logic and IoCs

This repository contains a yara and snort rules that can detect the Panchan cryptojacker.  
  
The full report about Panchan can be found in our [blogpost](https://akamai.com/blog/security/new-p2p-botnet-panchan).  

-----------------------
## Osquery
We're also including Osquery queries that can be run to look for malware IoCs  

### Malware files and process
`SELECT path FROM file WHERE path LIKE "/.%/xinetd";`  
`SELECT name, cmdline, pid FROM processes WHERE path LIKE "/.%/xinetd";`

### Persistence
`SELECT path FROM file WHERE path = "/bin/systemd-worker" or path = "/lib/systemd/system/systemd-worker.service";`  
`SELECT name, cmdline, pid FROM processes WHERE name = "systemd-worker";`

### Communication
`SELECT name, cmdline, pid FROM listening_ports INNER JOIN processes USING(pid) WHERE port=1919;`
